<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Книга рецептів</title>
</head>

<body>

<h2>Додати рецепт</h2>
<form id="recipeForm">
    <input type="text" id="name" placeholder="Назва рецепту" required><br><br>

    <input type="number" id="time" placeholder="Час приготування (хв)" required><br><br>

    <select id="category">
        <option>Суп</option>
        <option>Салат</option>
        <option>Десерт</option>
        <option>Основна страва</option>
    </select><br><br>

    <textarea id="ingredients" placeholder="Складові" required></textarea><br><br>

    Складність:<br>
    <label><input type="radio" name="difficulty" value="Легка" required> Легка</label><br>
    <label><input type="radio" name="difficulty" value="Середня"> Середня</label><br>
    <label><input type="radio" name="difficulty" value="Важка"> Важка</label><br><br>

    <label><input type="checkbox" id="fav"> Улюблений рецепт</label><br><br>

    <button type="submit">Додати</button>
</form>

<h2>Список рецептів</h2>
<div id="recipeList"></div>


<script>
// Завантаження рецептів з LocalStorage
let recipes = JSON.parse(localStorage.getItem("recipes")) || [];

// Збереження у LocalStorage
function saveRecipes() {
    localStorage.setItem("recipes", JSON.stringify(recipes));
}

// Вивід рецептів на сторінку
function renderRecipes() {
    const list = document.getElementById("recipeList");
    list.innerHTML = "";

    recipes.forEach((r, i) => {
        list.innerHTML += `
        <div style="border:1px solid #ccc; padding:10px; margin:10px 0;">
            <strong>${r.name}</strong> (${r.time} хв)<br>
            Категорія: ${r.category}<br>
            Складність: ${r.difficulty}<br>
            Складові: ${r.ingredients}<br>
            ${r.fav ? "<b>★ Улюблений</b>" : ""}
            <br><br>
            <button onclick="deleteRecipe(${i})">Видалити</button>
        </div>`;
    });
}

// Видалення рецепта
function deleteRecipe(index) {
    recipes.splice(index, 1);
    saveRecipes();
    renderRecipes();
}

// Додавання рецепта + Валідація
document.getElementById("recipeForm").addEventListener("submit", function(e) {
    e.preventDefault();

    // Регулярні вирази
    const nameRegex = /^[A-Za-zА-Яа-яІіЇїЄє\s]+$/;      
    const ingredientRegex = /^[A-Za-zА-Яа-яІіЇїЄє,\s]+$/;  
    const timeRegex = /^\d+(\.\d+)?$/;                    

    // Отримання значень
    const name = document.getElementById("name").value.trim();
    const time = document.getElementById("time").value.trim();
    const category = document.getElementById("category").value.trim();
    const ingredients = document.getElementById("ingredients").value.trim();
    const difficulty = document.querySelector('input[name="difficulty"]:checked')?.value;
    const fav = document.getElementById("fav").checked;

    // Перевірки
    if (!nameRegex.test(name)) {
        alert("❌ Назва рецепта може містити лише літери та пробіли.");
        return;
    }

    if (!timeRegex.test(time)) {
        alert("❌ Час має бути числом (5 або 4.5).");
        return;
    }

    if (!ingredientRegex.test(ingredients)) {
        alert("❌ Складові можуть містити лише літери, коми та пробіли.");
        return;
    }

    if (!difficulty) {
        alert("❌ Виберіть складність рецепта.");
        return;
    }

    const recipe = {
        name,
        time,
        category,
        ingredients,
        difficulty,
        fav
    };

    recipes.push(recipe);
    saveRecipes();
    renderRecipes();

    this.reset();
});

// Показати рецепти при завантаженні сторінки
renderRecipes();
</script>

</body>
</html>
